argo-cd:
  fullnameOverride: argo

  server:
    ingress:
      enabled: true
      annotations:
        # Avoid ERR_TOO_MANY_REDIRECTS
        nginx.ingress.kubernetes.io/rewrite-target: /
        # add an annotation indicating the issuer to use.
        cert-manager.io/cluster-issuer: letsencrypt-prod
      ingressClassName: nginx
      hosts:
        - argocd.k8s.aws-tests.skyworkz.nl
      tls:
        - hosts:
            - argocd.k8s.aws-tests.skyworkz.nl
          secretName: argocd-tls

  configs:
    cm:
      dex.config: |
        connectors:
        - type: github
          id: github
          name: GitHub
          config:
            clientID: Iv1.02232c940b8f7e13
            clientSecret: $github-client-secret:dex.github.clientSecret
            orgs:
            - name: skyworkz

      url: https://argocd.k8s.aws-tests.skyworkz.nl
    rbac:
      # -- The name of the default role which Argo CD will falls back to, when authorizing API requests (optional).
      # If omitted or empty, users may be still be able to login, but will see no apps, projects, etc...
      # Default: policy.default: ""
      policy.default: ''

      # Policy rules are in the form:
      #  p, subject, resource, action, object, effect
      # Role definitions and bindings are in the form:
      #  g, subject, inherited-subject
      # Default: policy.csv: ""
      policy.csv: |
        p, role:skyworkz-engineers-role, applications, create, */*, allow
        p, role:skyworkz-engineers-role, applications, delete, */*, allow
        p, role:skyworkz-engineers-role, applications, get, */*, allow
        p, role:skyworkz-engineers-role, applications, override, */*, allow
        p, role:skyworkz-engineers-role, applications, sync, */*, allow
        p, role:skyworkz-engineers-role, applications, update, */*, allow
        p, role:skyworkz-engineers-role, repositories, create, *, allow
        p, role:skyworkz-engineers-role, repositories, update, *, allow
        p, role:skyworkz-engineers-role, repositories, delete, *, allow
        g, skyworkz:Engineers, role:skyworkz-engineers-role
    params:
      server.insecure: true




